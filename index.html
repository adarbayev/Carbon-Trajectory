<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kömir Zero</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <section id="home-section">
        <h1 class="home-title">Kömir Zero</h1>
        <p class="home-subtitle">Model your emissions reduction scenarios and analyze costs with MACC analysis.</p>
        <button id="try-tool-btn" class="try-tool-btn">TRY the TRAJECTORY TOOL</button>
        <p class="attribution">
            Built by Anvar Darbayev
            <a href="https://www.linkedin.com/in/anvard/" target="_blank" rel="noopener noreferrer" title="Anvar Darbayev LinkedIn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                    <path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"></path>
                </svg>
            </a>
        </p>
    </section>

    <section id="tool-section" class="hidden opacity-0"> <button class="home-button" onclick="showHomePage()"> &larr; Home
        </button>

        <div class="tab-container mt-4">
            <div class="mb-4 border-b border-gray-200">
                <nav class="-mb-px flex" aria-label="Tabs">
                    <button id="tab-btn-dashboard" class="tab-button active" onclick="switchTab('dashboard')">Trajectory Dashboard</button>
                    <button id="tab-btn-macc" class="tab-button" onclick="switchTab('macc')">MACC Analysis</button>
                    <button id="tab-btn-wedges" class="tab-button" onclick="switchTab('wedges')">Abatement Wedges</button>
                </nav>
            </div>

            <div id="tab-content-dashboard" class="tab-content">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8">
                    <div class="lg:col-span-1 bg-white p-0 rounded-lg flex flex-col h-full">
                        <h2 class="section-header">Inputs</h2>
                        <div class="mb-6 border-b border-slate-200 pb-5">
                            <h3 class="subsection-header flex justify-between items-center">
                                <span>Baseline</span>
                                <button type="button" class="edit-btn text-sm" onclick="openBaselineModal()">Edit Baseline</button>
                            </h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label>Total Baseline Emissions</label>
                                    <div id="baseline-display" class="mt-1 p-2 border border-gray-200 rounded bg-gray-50 text-center font-medium">10000 tCO2eq</div>
                                </div>
                                <div>
                                    <label for="baseline-year">Baseline Year</label>
                                    <input type="number" id="baseline-year" value="2024" min="2015" max="2050" class="w-full shadow-sm">
                                </div>
                            </div>
                        </div>
                        <div class="mb-6 border-b border-slate-200 pb-5">
                             <h3 class="subsection-header flex justify-between items-center">
                                <span>Projections</span>
                                <button type="button" class="edit-btn text-sm" onclick="openGrowthRateModal()">Edit Growth Rates</button>
                            </h3>
                             <p class="text-xs text-slate-500 mt-1">Linear growth rates (% of baseline) applied per period.</p>
                             <div class="mt-2 p-2 border border-gray-200 rounded bg-gray-50 text-sm">
                                 <span id="growth-display-p1">P1 (2024-2030): 2.0%</span><br>
                                 <span id="growth-display-p2">P2 (2031-2040): 1.5%</span><br>
                                 <span id="growth-display-p3">P3 (2041-2050): 1.0%</span>
                             </div>
                        </div>
                         <div class="mb-6 border-b border-slate-200 pb-5">
                            <h3 class="subsection-header">Target</h3>
                             <div class="flex items-center mb-2">
                                 <input id="sbti-checkbox" type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                                 <label for="sbti-checkbox" class="ml-2 block text-sm text-gray-900">Align target with SBTi (1.5°C Pathway)?</label>
                             </div>
                             <p id="sbti-note" class="text-xs text-slate-500 mt-1 mb-3 hidden">Applies -42% by near-term target year (baseline+10yrs) and -90% by 2050 vs baseline year emissions.</p>
                             <div><label for="target-reduction">Manual 2050 Target Reduction (%)</label><input type="number" id="target-reduction" value="50" min="0" max="100" class="w-full shadow-sm"></div>
                        </div>
                        <div class="flex-grow flex flex-col">
                            <div class="flex justify-between items-center mb-4"><h2 class="section-header mb-0 pb-0 border-b-0">Scenarios</h2><button id="add-scenario-btn" class="add-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>Add Scenario</button></div>
                            <div id="scenarios-list" class="flex-grow overflow-y-auto -mr-3 pr-3 space-y-4" style="max-height: calc(70vh - 450px);"></div>
                        </div>
                    </div>
                    <div class="lg:col-span-2 p-0 rounded-lg">
                        <h2 class="section-header text-center mb-4">Emissions Trajectory (tCO2eq)</h2>
                        <div class="chart-container"><canvas id="trajectoryChart"></canvas></div>
                        <p class="text-xs text-slate-500 mt-4 text-center">*CAPEX and OPEX values are recorded but do not currently affect the emissions trajectory graph.</p>
                    </div>
                </div>
            </div>

            <div id="tab-content-macc" class="tab-content hidden">
                <div class="flex justify-end mb-4">
                    <label for="macc-year-select" class="mr-2 text-sm font-medium text-gray-700 self-center">Analysis Year:</label>
                    <select id="macc-year-select" class="w-24 border border-gray-300 rounded-md shadow-sm p-1.5 text-sm focus:ring-emerald-500 focus:border-emerald-500"></select>
                </div>
                <h2 class="section-header text-center mb-1">Marginal Abatement Cost Curve (MACC)</h2>
                <p id="macc-scenario-info" class="text-sm text-center text-slate-600 mb-4">Analysis based on measures in the first scenario.</p>
                <div class="macc-chart-container"><canvas id="maccChart"></canvas></div>
                <p class="text-xs text-slate-500 mt-4 text-center"> *X-axis shows measures sorted by MAC ($/tCO2eq). Bar height shows MAC.<br> *Calculations use **annualized** cost ((CAPEX/Lifecycle) + OPEX) and **annual** abatement (Baseline Scope*Reduction%*RampFactor), without discounting. </p>
            </div>

            <div id="tab-content-wedges" class="tab-content hidden">
                 <h2 class="section-header text-center mb-1">Abatement Wedges</h2>
                 <p id="wedge-scenario-info" class="text-sm text-center text-slate-600 mb-4">Shows cumulative annual abatement per measure for the first scenario.</p>
                 <div class="wedge-chart-container"><canvas id="wedgeChart"></canvas></div>
                 <p class="text-xs text-slate-500 mt-4 text-center">*Each colored area represents the annual abatement (tCO2eq/yr) contributed by a specific measure.</p>
            </div>
        </div>
    </section>

    <div id="baseline-modal" class="modal-overlay"> <div class="modal-content relative"> <button class="modal-close-btn" onclick="closeBaselineModal()">&times;</button> <h3 class="modal-header">Edit Baseline Emissions</h3> <div class="space-y-4"> <div><label for="modal-baseline-scope1" class="block text-sm font-medium text-gray-700 mb-1">Scope 1 Emissions (tCO2eq)</label><input type="number" id="modal-baseline-scope1" value="6000" min="0" class="w-full shadow-sm"></div> <div><label for="modal-baseline-scope2" class="block text-sm font-medium text-gray-700 mb-1">Scope 2 Emissions (tCO2eq)</label><input type="number" id="modal-baseline-scope2" value="4000" min="0" class="w-full shadow-sm"></div> </div> <div class="modal-footer"> <button type="button" class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50" onclick="closeBaselineModal()">Cancel</button> <button type="button" class="px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-indigo-700" onclick="saveBaselineModal()">Save Baseline</button> </div> </div> </div>
    <div id="growth-rate-modal" class="modal-overlay"> <div class="modal-content relative"> <button class="modal-close-btn" onclick="closeGrowthRateModal()">&times;</button> <h3 class="modal-header">Edit Growth Rates (% of Baseline / Year)</h3> <div class="space-y-4"> <div> <label id="modal-growth-p1-label" for="modal-growth-p1" class="block text-sm font-medium text-gray-700 mb-1">Period 1 (2024 - 2030)</label> <input type="number" id="modal-growth-p1" value="2.0" step="0.1" class="w-full shadow-sm"> </div> <div> <label for="modal-growth-p2" class="block text-sm font-medium text-gray-700 mb-1">Period 2 (2031 - 2040)</label> <input type="number" id="modal-growth-p2" value="1.5" step="0.1" class="w-full shadow-sm"> </div> <div> <label for="modal-growth-p3" class="block text-sm font-medium text-gray-700 mb-1">Period 3 (2041 - 2050)</label> <input type="number" id="modal-growth-p3" value="1.0" step="0.1" class="w-full shadow-sm"> </div> </div> <div class="modal-footer"> <button type="button" class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50" onclick="closeGrowthRateModal()">Cancel</button> <button type="button" class="px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-indigo-700" onclick="saveGrowthRateModal()">Save Rates</button> </div> </div> </div>
    <div id="measures-modal" class="modal-overlay"> <div class="modal-content relative"> <button class="modal-close-btn" onclick="closeMeasuresModal()">&times;</button> <h3 id="measures-modal-title" class="modal-header">Edit Measures for Scenario</h3> <div id="modal-measures-list" class="modal-measures-container max-h-96 overflow-y-auto pr-2 space-y-4 mb-4"></div> <button id="modal-add-measure-btn" class="add-btn w-full justify-center"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg> Add New Measure </button> <div class="modal-footer"> <button type="button" class="px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-indigo-700" onclick="saveAndCloseMeasuresModal()">Save and Close</button> </div> </div> </div>

    <script src="script.js" defer></script>

</body>
</html>
